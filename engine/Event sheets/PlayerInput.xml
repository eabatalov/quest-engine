<?xml version="1.0" encoding="utf-8" ?>
<c2eventsheet>
    <!--All the 'name' attributes are ignored by Construct 2 - they are there for readability only.-->
    <name>PlayerInput</name>
    <events>
        <variable constant="0" name="BlockPlayerInputOnSeqAction" sid="4976819164673977" static="0" type="number">0</variable>
        <variable constant="0" name="BlockPlayerAvatarControls" sid="4613878177283259" static="0" type="number">0</variable>
        <event-group collapsed="1" description="" sid="2830842349648749" title="PlayerInput">
            <sub-events>
                <comment>Initial = &quot;BLOCKED&quot;: block player input on start until game was inited</comment>
                <variable constant="0" name="INPUT_STATE" sid="3003482212209299" static="1" type="text">BLOCKED</variable>
                <event-block sid="1413375697139928">
                    <conditions>
                        <condition id="0" name="On function" sid="8355803232665031" type="Function">
                            <param id="0" name="Name">&quot;EnableInputAfterGameInited&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-9" name="Set value" sid="2574756175710693" type="System">
                            <param id="0" name="Variable">INPUT_STATE</param>
                            <param id="1" name="Value">&quot;IDLE&quot;</param>
                        </action>
                    </actions>
                </event-block>
                <event-group collapsed="1" description="" sid="9069475156831885" title="PlayerAvatarControlsEnableDisable">
                    <sub-events>
                        <event-block sid="8694111219489924">
                            <conditions>
                                <condition id="0" name="On function" sid="5825575074126567" type="Function">
                                    <param id="0" name="Name">&quot;EnablePlayerAvatarControls&quot;</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="7174361625186059" type="System">
                                    <param id="0" name="Variable">BlockPlayerAvatarControls</param>
                                    <param id="1" name="Value">0</param>
                                </action>
                                <action id="-15" name="Set visible" sid="8450681033080737" type="ControlLeft">
                                    <param id="0" name="Visibility">1</param>
                                </action>
                                <action id="-15" name="Set visible" sid="4215953835019314" type="ControlRight">
                                    <param id="0" name="Visibility">1</param>
                                </action>
                                <action id="-15" name="Set visible" sid="5031764874179612" type="ControlUp">
                                    <param id="0" name="Visibility">1</param>
                                </action>
                                <action id="-15" name="Set visible" sid="463979294614175" type="Clutch">
                                    <param id="0" name="Visibility">1</param>
                                </action>
                            </actions>
                        </event-block>
                        <comment>Set horizontal speed to 0 because it is not logically set to 0 when platform is disabled</comment>
                        <event-block sid="3870640516651617">
                            <conditions>
                                <condition id="0" name="On function" sid="2178727481963409" type="Function">
                                    <param id="0" name="Name">&quot;DisablePlayerAvatarControls&quot;</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="5620162536875308" type="System">
                                    <param id="0" name="Variable">BlockPlayerAvatarControls</param>
                                    <param id="1" name="Value">1</param>
                                </action>
                                <action behavior="Platform" id="8" name="Set vector X" sid="6313459378318555" type="PlayerPlatform">
                                    <param id="0" name="Vector X">0</param>
                                </action>
                                <action id="-15" name="Set visible" sid="6869784657833364" type="ControlLeft">
                                    <param id="0" name="Visibility">0</param>
                                </action>
                                <action id="-15" name="Set visible" sid="9430945953897008" type="ControlRight">
                                    <param id="0" name="Visibility">0</param>
                                </action>
                                <action id="-15" name="Set visible" sid="5401697065102518" type="ControlUp">
                                    <param id="0" name="Visibility">0</param>
                                </action>
                                <action id="-15" name="Set visible" sid="37714701268698" type="Clutch">
                                    <param id="0" name="Visibility">0</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-group>
                <event-group collapsed="1" description="" sid="2039030482302605" title="PlayerAvatarControls">
                    <sub-events>
                        <event-block sid="9342819312308766">
                            <conditions>
                                <condition id="0" name="On function" sid="1546118214549502" type="Function">
                                    <param id="0" name="Name">&quot;PlayerInputLeft&quot;</param>
                                </condition>
                                <condition id="-8" name="Compare two values" sid="1833462567661928" type="System">
                                    <param id="0" name="First value">BlockPlayerInputOnSeqAction</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Second value">0</param>
                                </condition>
                                <condition id="-8" name="Compare two values" sid="663044184148649" type="System">
                                    <param id="0" name="First value">BlockPlayerAvatarControls</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Second value">0</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action behavior="Platform" id="7" name="Simulate control" sid="9061341482689768" type="PlayerPlatform">
                                    <param id="0" name="Control">0</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="9329715248934294">
                            <conditions>
                                <condition id="0" name="On function" sid="6022184579517512" type="Function">
                                    <param id="0" name="Name">&quot;PlayerInputUp&quot;</param>
                                </condition>
                                <condition id="-8" name="Compare two values" sid="8712063027820289" type="System">
                                    <param id="0" name="First value">BlockPlayerInputOnSeqAction</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Second value">0</param>
                                </condition>
                                <condition id="-8" name="Compare two values" sid="8849649317273765" type="System">
                                    <param id="0" name="First value">BlockPlayerAvatarControls</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Second value">0</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action behavior="Platform" id="7" name="Simulate control" sid="5342964455517997" type="PlayerPlatform">
                                    <param id="0" name="Control">2</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="3302552265671319">
                            <conditions>
                                <condition id="0" name="On function" sid="6310757107772057" type="Function">
                                    <param id="0" name="Name">&quot;PlayerInputRight&quot;</param>
                                </condition>
                                <condition id="-8" name="Compare two values" sid="9335819726027978" type="System">
                                    <param id="0" name="First value">BlockPlayerInputOnSeqAction</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Second value">0</param>
                                </condition>
                                <condition id="-8" name="Compare two values" sid="4505893252888946" type="System">
                                    <param id="0" name="First value">BlockPlayerAvatarControls</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Second value">0</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action behavior="Platform" id="7" name="Simulate control" sid="2342917029191362" type="PlayerPlatform">
                                    <param id="0" name="Control">1</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block collapsed="1" sid="197122408042268">
                            <conditions>
                                <condition id="-8" name="Compare two values" sid="4782168766558299" type="System">
                                    <param id="0" name="First value">INPUT_STATE</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Second value">&quot;IDLE&quot;</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="7771541835111028">
                                    <conditions>
                                        <condition id="2" name="Key is down" sid="482642893718096" type="Keyboard">
                                            <param id="0" name="Key">37 (Left arrow)</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="7419849372254639" type="System">
                                            <param id="0" name="Variable">INPUT_STATE</param>
                                            <param id="1" name="Value">&quot;KEYBOARD_INPUT&quot;</param>
                                        </action>
                                        <action id="0" name="Call function" sid="6405561002478097" type="Function">
                                            <param id="0" name="Name">&quot;PlayerInputLeft&quot;</param>
                                            <param id="1" name="Parameter {n}"></param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="1880647738479693">
                                    <conditions>
                                        <condition id="2" name="Key is down" sid="5687427623885816" type="Keyboard">
                                            <param id="0" name="Key">38 (Up arrow)</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="885911481618988" type="System">
                                            <param id="0" name="Variable">INPUT_STATE</param>
                                            <param id="1" name="Value">&quot;KEYBOARD_INPUT&quot;</param>
                                        </action>
                                        <action id="0" name="Call function" sid="5077595105849989" type="Function">
                                            <param id="0" name="Name">&quot;PlayerInputUp&quot;</param>
                                            <param id="1" name="Parameter {n}"></param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="6085245019549563">
                                    <conditions>
                                        <condition id="2" name="Key is down" sid="9578522792593463" type="Keyboard">
                                            <param id="0" name="Key">39 (Right arrow)</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="6883124245071537" type="System">
                                            <param id="0" name="Variable">INPUT_STATE</param>
                                            <param id="1" name="Value">&quot;KEYBOARD_INPUT&quot;</param>
                                        </action>
                                        <action id="0" name="Call function" sid="7264654964244324" type="Function">
                                            <param id="0" name="Name">&quot;PlayerInputRight&quot;</param>
                                            <param id="1" name="Parameter {n}"></param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block collapsed="1" sid="7445959502215616">
                            <conditions>
                                <condition id="-8" name="Compare two values" sid="2926742354425532" type="System">
                                    <param id="0" name="First value">INPUT_STATE</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Second value">&quot;IDLE&quot;</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="2460676147359561">
                                    <conditions>
                                        <condition id="4" name="Is touching object" sid="7872365098574892" type="Touch">
                                            <param id="0" name="Object">ControlLeft</param>
                                        </condition>
                                        <condition id="-9" name="Is visible" sid="8925607421898263" type="ControlLeft" />
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="5170684600142153" type="System">
                                            <param id="0" name="Variable">INPUT_STATE</param>
                                            <param id="1" name="Value">&quot;TOUCHING_CONTROLS&quot;</param>
                                        </action>
                                        <action id="4" name="Set animation" sid="7650812421285198" type="ControlLeft">
                                            <param id="0" name="Animation">&quot;Active&quot;</param>
                                            <param id="1" name="From">1</param>
                                        </action>
                                        <action id="0" name="Call function" sid="1381328286345111" type="Function">
                                            <param id="0" name="Name">&quot;PlayerInputLeft&quot;</param>
                                            <param id="1" name="Parameter {n}"></param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="9756299718136993">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="9627294804092428" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="4" name="Set animation" sid="2328713855887697" type="ControlLeft">
                                            <param id="0" name="Animation">&quot;Inactive&quot;</param>
                                            <param id="1" name="From">1</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="5531821665335205">
                                    <conditions>
                                        <condition id="4" name="Is touching object" sid="9874340185052395" type="Touch">
                                            <param id="0" name="Object">ControlUp</param>
                                        </condition>
                                        <condition id="-9" name="Is visible" sid="9834970139350979" type="ControlUp" />
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="7555495061262899" type="System">
                                            <param id="0" name="Variable">INPUT_STATE</param>
                                            <param id="1" name="Value">&quot;TOUCHING_CONTROLS&quot;</param>
                                        </action>
                                        <action id="4" name="Set animation" sid="8836589157188082" type="ControlUp">
                                            <param id="0" name="Animation">&quot;Active&quot;</param>
                                            <param id="1" name="From">1</param>
                                        </action>
                                        <action id="0" name="Call function" sid="7159468804663727" type="Function">
                                            <param id="0" name="Name">&quot;PlayerInputUp&quot;</param>
                                            <param id="1" name="Parameter {n}"></param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="3873808371261588">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="9264341892091276" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="4" name="Set animation" sid="4335675320092437" type="ControlUp">
                                            <param id="0" name="Animation">&quot;Inactive&quot;</param>
                                            <param id="1" name="From">1</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="7873564285693736">
                                    <conditions>
                                        <condition id="4" name="Is touching object" sid="5011398372712242" type="Touch">
                                            <param id="0" name="Object">ControlRight</param>
                                        </condition>
                                        <condition id="-9" name="Is visible" sid="9263402890969975" type="ControlRight" />
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="2483349212815995" type="System">
                                            <param id="0" name="Variable">INPUT_STATE</param>
                                            <param id="1" name="Value">&quot;TOUCHING_CONTROLS&quot;</param>
                                        </action>
                                        <action id="4" name="Set animation" sid="474836760416093" type="ControlRight">
                                            <param id="0" name="Animation">&quot;Active&quot;</param>
                                            <param id="1" name="From">1</param>
                                        </action>
                                        <action id="0" name="Call function" sid="1602582459151894" type="Function">
                                            <param id="0" name="Name">&quot;PlayerInputRight&quot;</param>
                                            <param id="1" name="Parameter {n}"></param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="299444559484168">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="653012421233769" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="4" name="Set animation" sid="3185710203343802" type="ControlRight">
                                            <param id="0" name="Animation">&quot;Inactive&quot;</param>
                                            <param id="1" name="From">1</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-group>
                <event-group collapsed="1" description="" sid="6040864831798009" title="GameObjectsClicking">
                    <sub-events>
                        <comment>Simple tap processing by objects priority</comment>
                        <event-block collapsed="1" sid="4129211300491289">
                            <conditions>
                                <condition id="11" name="On Nth touch end" sid="8899231525800434" type="Touch">
                                    <param id="0" name="Touch number">0</param>
                                </condition>
                                <condition id="-8" name="Compare two values" sid="896470768932693" type="System">
                                    <param id="0" name="First value">INPUT_STATE</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Second value">&quot;IDLE&quot;</param>
                                </condition>
                                <condition id="-8" name="Compare two values" sid="4024693441615328" type="System">
                                    <param id="0" name="First value">BlockPlayerInputOnSeqAction</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Second value">0</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-group description="" sid="5517294302164264" title="Popup">
                                    <sub-events>
                                        <event-block sid="8249511115853068">
                                            <conditions />
                                            <actions>
                                                <action id="0" name="Call function" sid="6843450817485102" type="Function">
                                                    <param id="0" name="Name">&quot;procPopupClick&quot;</param>
                                                    <param id="1" name="Parameter {n}"></param>
                                                </action>
                                            </actions>
                                            <sub-events>
                                                <event-block sid="6766529204618615">
                                                    <conditions>
                                                        <condition id="-8" name="Compare two values" sid="1974728964434956" type="System">
                                                            <param id="0" name="First value">Function.ReturnValue</param>
                                                            <param id="1" name="Comparison">0</param>
                                                            <param id="2" name="Second value">0</param>
                                                        </condition>
                                                    </conditions>
                                                    <actions />
                                                    <sub-events>
                                                        <event-group description="" sid="5214444652765175" title="InputNotification">
                                                            <sub-events>
                                                                <comment>Global notification object can only be managed from the main storyline containing player</comment>
                                                                <event-block sid="960429598980419">
                                                                    <conditions>
                                                                        <condition id="4" name="Is touching object" sid="9925287132948592" type="Touch">
                                                                            <param id="0" name="Object">NotificationNextBtn</param>
                                                                        </condition>
                                                                        <condition id="-9" name="Is visible" sid="2879201464132348" type="NotificationNextBtn" />
                                                                    </conditions>
                                                                    <actions>
                                                                        <action id="0" name="Call function" sid="2356844301923021" type="Function">
                                                                            <param id="0" name="Name">&quot;ProcPlayerAction&quot;</param>
                                                                            <param id="1" name="Parameter {n}">&quot;NEXT&quot;{###}&quot;Player&quot;</param>
                                                                        </action>
                                                                    </actions>
                                                                </event-block>
                                                                <event-block sid="4871650670022659">
                                                                    <conditions>
                                                                        <condition id="-22" name="Else" sid="9715920151767901" type="System" />
                                                                    </conditions>
                                                                    <actions />
                                                                    <sub-events>
                                                                        <event-group description="" sid="4613929316449932" title="InputQuizz">
                                                                            <sub-events>
                                                                                <event-block sid="3610033099566428">
                                                                                    <conditions>
                                                                                        <condition id="4" name="Is touching object" sid="7378105216803644" type="Touch">
                                                                                            <param id="0" name="Object">PlayerAnsBg</param>
                                                                                        </condition>
                                                                                        <condition id="-9" name="Is visible" sid="3465709122755686" type="PlayerAnsBg" />
                                                                                    </conditions>
                                                                                    <actions />
                                                                                    <sub-events>
                                                                                        <event-group description="" sid="5570490472434793" title="InputQuizzPlayer">
                                                                                            <sub-events>
                                                                                                <event-block sid="9244327915283871">
                                                                                                    <conditions>
                                                                                                        <condition id="4" name="Is touching object" sid="1434369844323443" type="Touch">
                                                                                                            <param id="0" name="Object">PlayerAns1Bg</param>
                                                                                                        </condition>
                                                                                                        <condition id="-9" name="Is visible" sid="6797709380103244" type="PlayerAns1Bg" />
                                                                                                    </conditions>
                                                                                                    <actions>
                                                                                                        <action id="0" name="Call function" sid="7811283706256179" type="Function">
                                                                                                            <param id="0" name="Name">&quot;ProcPlayerAction&quot;</param>
                                                                                                            <param id="1" name="Parameter {n}">&quot;ANSWER1_CLICKED&quot;{###}&quot;Player&quot;</param>
                                                                                                        </action>
                                                                                                    </actions>
                                                                                                </event-block>
                                                                                                <event-block sid="808987273599126">
                                                                                                    <conditions>
                                                                                                        <condition id="4" name="Is touching object" sid="6641418128777404" type="Touch">
                                                                                                            <param id="0" name="Object">PlayerAns2Bg</param>
                                                                                                        </condition>
                                                                                                        <condition id="-9" name="Is visible" sid="4970102135846657" type="PlayerAns2Bg" />
                                                                                                    </conditions>
                                                                                                    <actions>
                                                                                                        <action id="0" name="Call function" sid="5394762814746551" type="Function">
                                                                                                            <param id="0" name="Name">&quot;ProcPlayerAction&quot;</param>
                                                                                                            <param id="1" name="Parameter {n}">&quot;ANSWER2_CLICKED&quot;{###}&quot;Player&quot;</param>
                                                                                                        </action>
                                                                                                    </actions>
                                                                                                </event-block>
                                                                                                <event-block sid="5220466744524609">
                                                                                                    <conditions>
                                                                                                        <condition id="4" name="Is touching object" sid="4807380925583589" type="Touch">
                                                                                                            <param id="0" name="Object">PlayerAns3Bg</param>
                                                                                                        </condition>
                                                                                                        <condition id="-9" name="Is visible" sid="8578014771509128" type="PlayerAns3Bg" />
                                                                                                    </conditions>
                                                                                                    <actions>
                                                                                                        <action id="0" name="Call function" sid="5325243694070209" type="Function">
                                                                                                            <param id="0" name="Name">&quot;ProcPlayerAction&quot;</param>
                                                                                                            <param id="1" name="Parameter {n}">&quot;ANSWER3_CLICKED&quot;{###}&quot;Player&quot;</param>
                                                                                                        </action>
                                                                                                    </actions>
                                                                                                </event-block>
                                                                                                <event-block sid="3092933683416641">
                                                                                                    <conditions>
                                                                                                        <condition id="4" name="Is touching object" sid="7297907820306031" type="Touch">
                                                                                                            <param id="0" name="Object">PlayerAns4Bg</param>
                                                                                                        </condition>
                                                                                                        <condition id="-9" name="Is visible" sid="7217080684525388" type="PlayerAns4Bg" />
                                                                                                    </conditions>
                                                                                                    <actions>
                                                                                                        <action id="0" name="Call function" sid="745843360394716" type="Function">
                                                                                                            <param id="0" name="Name">&quot;ProcPlayerAction&quot;</param>
                                                                                                            <param id="1" name="Parameter {n}">&quot;ANSWER4_CLICKED&quot;{###}&quot;Player&quot;</param>
                                                                                                        </action>
                                                                                                    </actions>
                                                                                                </event-block>
                                                                                            </sub-events>
                                                                                        </event-group>
                                                                                    </sub-events>
                                                                                </event-block>
                                                                                <event-block sid="6967947847990003">
                                                                                    <conditions>
                                                                                        <condition id="-22" name="Else" sid="9856103202906761" type="System" />
                                                                                        <condition id="4" name="Is touching object" sid="9988554973933489" type="Touch">
                                                                                            <param id="0" name="Object">NPCAnsBg</param>
                                                                                        </condition>
                                                                                        <condition id="-9" name="Is visible" sid="2742014454859619" type="NPCAnsBg" />
                                                                                    </conditions>
                                                                                    <actions />
                                                                                    <sub-events>
                                                                                        <event-group description="" sid="2410898144104873" title="InputQuizzNPC">
                                                                                            <sub-events>
                                                                                                <event-block sid="9244327915283871">
                                                                                                    <conditions>
                                                                                                        <condition id="4" name="Is touching object" sid="8492629149623324" type="Touch">
                                                                                                            <param id="0" name="Object">NPCAns1Bg</param>
                                                                                                        </condition>
                                                                                                        <condition id="-9" name="Is visible" sid="8524170090058752" type="NPCAns1Bg" />
                                                                                                    </conditions>
                                                                                                    <actions>
                                                                                                        <action id="0" name="Call function" sid="5188113430253159" type="Function">
                                                                                                            <param id="0" name="Name">&quot;ProcPlayerAction&quot;</param>
                                                                                                            <param id="1" name="Parameter {n}">&quot;ANSWER1_CLICKED&quot;{###}NPC.NpcIDInStage</param>
                                                                                                        </action>
                                                                                                    </actions>
                                                                                                </event-block>
                                                                                                <event-block sid="6295839870821978">
                                                                                                    <conditions>
                                                                                                        <condition id="4" name="Is touching object" sid="7243934845188166" type="Touch">
                                                                                                            <param id="0" name="Object">NPCAns2Bg</param>
                                                                                                        </condition>
                                                                                                        <condition id="-9" name="Is visible" sid="5277225986935538" type="NPCAns2Bg" />
                                                                                                    </conditions>
                                                                                                    <actions>
                                                                                                        <action id="0" name="Call function" sid="3565961746369076" type="Function">
                                                                                                            <param id="0" name="Name">&quot;ProcPlayerAction&quot;</param>
                                                                                                            <param id="1" name="Parameter {n}">&quot;ANSWER2_CLICKED&quot;{###}NPC.NpcIDInStage</param>
                                                                                                        </action>
                                                                                                    </actions>
                                                                                                </event-block>
                                                                                                <event-block sid="5220466744524609">
                                                                                                    <conditions>
                                                                                                        <condition id="4" name="Is touching object" sid="6620377190070372" type="Touch">
                                                                                                            <param id="0" name="Object">NPCAns3Bg</param>
                                                                                                        </condition>
                                                                                                        <condition id="-9" name="Is visible" sid="1113446108244117" type="NPCAns3Bg" />
                                                                                                    </conditions>
                                                                                                    <actions>
                                                                                                        <action id="0" name="Call function" sid="8542932235301472" type="Function">
                                                                                                            <param id="0" name="Name">&quot;ProcPlayerAction&quot;</param>
                                                                                                            <param id="1" name="Parameter {n}">&quot;ANSWER3_CLICKED&quot;{###}NPC.NpcIDInStage</param>
                                                                                                        </action>
                                                                                                    </actions>
                                                                                                </event-block>
                                                                                                <event-block sid="3092933683416641">
                                                                                                    <conditions>
                                                                                                        <condition id="4" name="Is touching object" sid="9417051112446105" type="Touch">
                                                                                                            <param id="0" name="Object">NPCAns4Bg</param>
                                                                                                        </condition>
                                                                                                        <condition id="-9" name="Is visible" sid="3539413976546757" type="NPCAns4Bg" />
                                                                                                    </conditions>
                                                                                                    <actions>
                                                                                                        <action id="0" name="Call function" sid="5660083931098062" type="Function">
                                                                                                            <param id="0" name="Name">&quot;ProcPlayerAction&quot;</param>
                                                                                                            <param id="1" name="Parameter {n}">&quot;ANSWER4_CLICKED&quot;{###}NPC.NpcIDInStage</param>
                                                                                                        </action>
                                                                                                    </actions>
                                                                                                </event-block>
                                                                                            </sub-events>
                                                                                        </event-group>
                                                                                    </sub-events>
                                                                                </event-block>
                                                                                <event-block sid="3599448319066088">
                                                                                    <conditions>
                                                                                        <condition id="-22" name="Else" sid="7280772023547169" type="System" />
                                                                                    </conditions>
                                                                                    <actions />
                                                                                    <sub-events>
                                                                                        <event-group description="" sid="1445189008455471" title="InputBalloon">
                                                                                            <sub-events>
                                                                                                <event-block sid="576738969998819">
                                                                                                    <conditions>
                                                                                                        <condition id="4" name="Is touching object" sid="2068350486640474" type="Touch">
                                                                                                            <param id="0" name="Object">NPCSpeechNextBtn</param>
                                                                                                        </condition>
                                                                                                        <condition id="-9" name="Is visible" sid="4980821966843262" type="NPCSpeechNextBtn" />
                                                                                                    </conditions>
                                                                                                    <actions>
                                                                                                        <action id="0" name="Call function" sid="7342972398969219" type="Function">
                                                                                                            <param id="0" name="Name">&quot;ProcPlayerAction&quot;</param>
                                                                                                            <param id="1" name="Parameter {n}">&quot;NEXT&quot;{###}NPC.NpcIDInStage</param>
                                                                                                        </action>
                                                                                                    </actions>
                                                                                                </event-block>
                                                                                                <event-block sid="9061294361655323">
                                                                                                    <conditions>
                                                                                                        <condition id="-22" name="Else" sid="1407190567127321" type="System" />
                                                                                                    </conditions>
                                                                                                    <actions />
                                                                                                    <sub-events>
                                                                                                        <event-block sid="1321310949359807">
                                                                                                            <conditions>
                                                                                                                <condition id="4" name="Is touching object" sid="9744078061826525" type="Touch">
                                                                                                                    <param id="0" name="Object">PlayerSpeechNextBtn</param>
                                                                                                                </condition>
                                                                                                                <condition id="-9" name="Is visible" sid="7646473691644654" type="PlayerSpeechNextBtn" />
                                                                                                            </conditions>
                                                                                                            <actions>
                                                                                                                <action id="0" name="Call function" sid="4553815621528198" type="Function">
                                                                                                                    <param id="0" name="Name">&quot;ProcPlayerAction&quot;</param>
                                                                                                                    <param id="1" name="Parameter {n}">&quot;NEXT&quot;{###}&quot;Player&quot;</param>
                                                                                                                </action>
                                                                                                            </actions>
                                                                                                        </event-block>
                                                                                                        <event-block sid="4091458548572446">
                                                                                                            <conditions>
                                                                                                                <condition id="-22" name="Else" sid="9148458480902659" type="System" />
                                                                                                            </conditions>
                                                                                                            <actions />
                                                                                                            <sub-events>
                                                                                                                <event-group description="" sid="1039263380297501" title="InputCharacter">
                                                                                                                    <sub-events>
                                                                                                                        <event-block sid="305809026854194">
                                                                                                                            <conditions>
                                                                                                                                <condition id="4" name="Is touching object" sid="2159834147064531" type="Touch">
                                                                                                                                    <param id="0" name="Object">NPC</param>
                                                                                                                                </condition>
                                                                                                                                <condition disabled="1" id="-9" name="Is visible" sid="9116048015684113" type="NPC" />
                                                                                                                                <condition id="-8" name="Compare two values" sid="7962307094023783" type="System">
                                                                                                                                    <param id="0" name="First value">NPC.Stage</param>
                                                                                                                                    <param id="1" name="Comparison">0</param>
                                                                                                                                    <param id="2" name="Second value">Player.CurrentStage</param>
                                                                                                                                </condition>
                                                                                                                            </conditions>
                                                                                                                            <actions>
                                                                                                                                <action id="0" name="Call function" sid="2801554626570156" type="Function">
                                                                                                                                    <param id="0" name="Name">&quot;ProcPlayerAction&quot;</param>
                                                                                                                                    <param id="1" name="Parameter {n}">&quot;NPC_CLICKED&quot;{###}NPC.NpcIDInStage</param>
                                                                                                                                </action>
                                                                                                                            </actions>
                                                                                                                        </event-block>
                                                                                                                        <event-block sid="2359110758246322">
                                                                                                                            <conditions>
                                                                                                                                <condition id="-22" name="Else" sid="1712268859280778" type="System" />
                                                                                                                            </conditions>
                                                                                                                            <actions />
                                                                                                                            <sub-events>
                                                                                                                                <event-block sid="5786268401515178">
                                                                                                                                    <conditions>
                                                                                                                                        <condition id="4" name="Is touching object" sid="318352182056772" type="Touch">
                                                                                                                                            <param id="0" name="Object">Player</param>
                                                                                                                                        </condition>
                                                                                                                                        <condition disabled="1" id="-9" name="Is visible" sid="7582195372336179" type="Player" />
                                                                                                                                    </conditions>
                                                                                                                                    <actions>
                                                                                                                                        <action id="0" name="Call function" sid="881150191223577" type="Function">
                                                                                                                                            <param id="0" name="Name">&quot;ProcPlayerAction&quot;</param>
                                                                                                                                            <param id="1" name="Parameter {n}">&quot;PLAYER_CLICKED&quot;{###}&quot;Player&quot;</param>
                                                                                                                                        </action>
                                                                                                                                    </actions>
                                                                                                                                </event-block>
                                                                                                                                <event-block sid="6525356835386544">
                                                                                                                                    <conditions>
                                                                                                                                        <condition id="-22" name="Else" sid="8839686895546002" type="System" />
                                                                                                                                    </conditions>
                                                                                                                                    <actions />
                                                                                                                                    <sub-events>
                                                                                                                                        <comment>As game objects clicking processed here always has the highest input priority we can process input on all the other objects here</comment>
                                                                                                                                        <event-block sid="2115976426562099">
                                                                                                                                            <conditions />
                                                                                                                                            <actions>
                                                                                                                                                <action id="0" name="Call function" sid="8561163136980402" type="Function">
                                                                                                                                                    <param id="0" name="Name">&quot;procSpecialControls&quot;</param>
                                                                                                                                                    <param id="1" name="Parameter {n}"></param>
                                                                                                                                                </action>
                                                                                                                                            </actions>
                                                                                                                                        </event-block>
                                                                                                                                        <event-block sid="2908475218621934">
                                                                                                                                            <conditions>
                                                                                                                                                <condition id="-8" name="Compare two values" sid="7774944738033263" type="System">
                                                                                                                                                    <param id="0" name="First value">Function.ReturnValue</param>
                                                                                                                                                    <param id="1" name="Comparison">0</param>
                                                                                                                                                    <param id="2" name="Second value">0</param>
                                                                                                                                                </condition>
                                                                                                                                            </conditions>
                                                                                                                                            <actions>
                                                                                                                                                <action id="0" name="Call function" sid="4227935258099288" type="Function">
                                                                                                                                                    <param id="0" name="Name">&quot;procMiscInput&quot; &amp; Player.CurrentStage</param>
                                                                                                                                                    <param id="1" name="Parameter {n}"></param>
                                                                                                                                                </action>
                                                                                                                                            </actions>
                                                                                                                                        </event-block>
                                                                                                                                    </sub-events>
                                                                                                                                </event-block>
                                                                                                                            </sub-events>
                                                                                                                        </event-block>
                                                                                                                    </sub-events>
                                                                                                                </event-group>
                                                                                                            </sub-events>
                                                                                                        </event-block>
                                                                                                    </sub-events>
                                                                                                </event-block>
                                                                                            </sub-events>
                                                                                        </event-group>
                                                                                    </sub-events>
                                                                                </event-block>
                                                                            </sub-events>
                                                                        </event-group>
                                                                    </sub-events>
                                                                </event-block>
                                                            </sub-events>
                                                        </event-group>
                                                    </sub-events>
                                                </event-block>
                                            </sub-events>
                                        </event-block>
                                    </sub-events>
                                </event-group>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-group>
                <event-block sid="4773156587166359">
                    <conditions>
                        <condition id="-8" name="Compare two values" sid="4094515129338966" type="System">
                            <param id="0" name="First value">INPUT_STATE</param>
                            <param id="1" name="Comparison">1</param>
                            <param id="2" name="Second value">&quot;BLOCKED&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-9" name="Set value" sid="4772601113739412" type="System">
                            <param id="0" name="Variable">INPUT_STATE</param>
                            <param id="1" name="Value">&quot;IDLE&quot;</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
        <event-group collapsed="1" description="" sid="332469586418499" title="Stage changer">
            <sub-events>
                <event-block sid="9949365663832994">
                    <conditions>
                        <condition id="0" name="On collision with another object" sid="6721803164694401" type="Player">
                            <param id="0" name="Object">StageChanger</param>
                        </condition>
                        <condition id="-8" name="Compare two values" sid="9836145392664095" type="System">
                            <param id="0" name="First value">BlockPlayerInputOnSeqAction</param>
                            <param id="1" name="Comparison">0</param>
                            <param id="2" name="Second value">0</param>
                        </condition>
                        <condition id="-8" name="Compare two values" sid="2039766089303173" type="System">
                            <param id="0" name="First value">Player.CurrentStage</param>
                            <param id="1" name="Comparison">1</param>
                            <param id="2" name="Second value">StageChanger.Stage</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="0" name="Call function" sid="6251768207915564" type="Function">
                            <param id="0" name="Name">&quot;ChangeStage&quot;</param>
                            <param id="1" name="Parameter {n}">StageChanger.Stage</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="7609698910929058">
                    <conditions>
                        <condition id="0" name="On collision with another object" sid="1160313490422418" type="Player">
                            <param id="0" name="Object">CrankyStageChanger</param>
                        </condition>
                        <condition id="-8" name="Compare two values" sid="8702323885905916" type="System">
                            <param id="0" name="First value">BlockPlayerInputOnSeqAction</param>
                            <param id="1" name="Comparison">0</param>
                            <param id="2" name="Second value">0</param>
                        </condition>
                        <condition id="-8" name="Compare two values" sid="9033207215331274" type="System">
                            <param id="0" name="First value">Player.CurrentStage</param>
                            <param id="1" name="Comparison">1</param>
                            <param id="2" name="Second value">CrankyStageChanger.Stage</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="0" name="Call function" sid="8040100302080544" type="Function">
                            <param id="0" name="Name">&quot;ChangeStage&quot;</param>
                            <param id="1" name="Parameter {n}">CrankyStageChanger.Stage</param>
                        </action>
                    </actions>
                </event-block>
                <comment>Change stage context and render current UI action on stage</comment>
                <comment>p(0): new stage name</comment>
                <event-block sid="6811936083988063">
                    <conditions>
                        <condition id="0" name="On function" sid="3098069443372747" type="Function">
                            <param id="0" name="Name">&quot;ChangeStage&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="0" name="Call function" sid="7107882144466008" type="Function">
                            <param id="0" name="Name">&quot;onStage&quot; &amp; Player.CurrentStage&amp; &quot;Inactive&quot;</param>
                            <param id="1" name="Parameter {n}"></param>
                        </action>
                        <action id="0" name="Call function" sid="7588886292693031" type="Function">
                            <param id="0" name="Name">&quot;HideStageUI&quot;</param>
                            <param id="1" name="Parameter {n}">Player.CurrentStage</param>
                        </action>
                        <action id="-10" name="Set value" sid="7257467278459108" type="Player">
                            <param id="0" name="Instance variable">CurrentStage</param>
                            <param id="1" name="Value">Function.Param(0)</param>
                        </action>
                        <action id="0" name="Set current stage" sid="7157665240375644" type="QuestRuntimeInterface">
                            <param id="0" name="Value">Function.Param(0)</param>
                        </action>
                        <action id="0" name="Call function" sid="3525188631633559" type="Function">
                            <param id="0" name="Name">&quot;ProcUIAction&quot;</param>
                            <param id="1" name="Parameter {n}"></param>
                        </action>
                        <action id="0" name="Call function" sid="2064427168564408" type="Function">
                            <param id="0" name="Name">&quot;onStage&quot; &amp; StageChanger.Stage &amp; &quot;Active&quot;</param>
                            <param id="1" name="Parameter {n}"></param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="3984117986249243" title="Automatic start talk">
            <sub-events>
                <comment>Inject custom event with name &quot;auto_talk_start_&quot; + NPC id to start talking</comment>
                <event-block sid="7124879317616865">
                    <conditions>
                        <condition id="0" name="On collision with another object" sid="7991193214109111" type="TalkStartTrigger">
                            <param id="0" name="Object">PlayerMiddleMarker</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="881256367298289">
                            <conditions>
                                <condition id="-7" name="Compare instance variable" sid="8273393451485714" type="TalkStartTrigger">
                                    <param id="0" name="Instance variable">FireOnce</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">1</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Destroy" sid="8097163933482469" type="TalkStartHighlight" />
                                <action id="-9" name="Destroy" sid="2640317491128253" type="TalkStartTrigger" />
                            </actions>
                        </event-block>
                        <event-block sid="421426358105787">
                            <conditions>
                                <condition id="-8" name="Compare two values" sid="8589615490797181" type="System">
                                    <param id="0" name="First value">PlayerPlatform.Platform.VectorX</param>
                                    <param id="1" name="Comparison">2</param>
                                    <param id="2" name="Second value">0</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action behavior="Platform" id="8" name="Set vector X" sid="7738017988602158" type="PlayerPlatform">
                                    <param id="0" name="Vector X">0</param>
                                </action>
                                <action id="2" name="Set object scale ratio" sid="4094644124897855" type="PlayerSCML">
                                    <param id="0" name="Scale Ratio">PlayerSCML.ScaleRatio</param>
                                    <param id="1" name="Flip X Axis">0</param>
                                    <param id="2" name="Flip Y Axis">0</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="2309060373181358">
                            <conditions />
                            <actions>
                                <action id="0" name="Call function" sid="8550995941394823" type="Function">
                                    <param id="0" name="Name">&quot;ProcPlayerCustomEvent&quot;</param>
                                    <param id="1" name="Parameter {n}">&quot;auto_talk_start_&quot;  &amp; TalkStartTrigger.NpcIDInStage{###}&quot;Player&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
    </events>
</c2eventsheet>
